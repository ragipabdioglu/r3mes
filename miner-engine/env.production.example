# R3MES Miner Engine Production Environment Configuration
# Copy this file to .env.production and fill in actual values

# ============================================================================
# Blockchain Configuration
# ============================================================================
# Chain ID for production
CHAIN_ID=remes-mainnet-1

# Blockchain gRPC URL (for transaction submission and queries)
# REQUIRED in production - do NOT use localhost
R3MES_NODE_GRPC_URL=grpc.r3mes.network:9090

# Blockchain REST API URL (alternative query method)
# REQUIRED in production - do NOT use localhost
R3MES_BLOCKCHAIN_REST_URL=https://rpc.r3mes.network

# Blockchain RPC URL (Tendermint RPC)
# REQUIRED in production - do NOT use localhost
R3MES_BLOCKCHAIN_RPC_URL=https://rpc.r3mes.network:26657

# ============================================================================
# IPFS Configuration
# ============================================================================
# IPFS daemon URL
# REQUIRED in production - do NOT use localhost
R3MES_IPFS_URL=/ip4/your-ipfs-node-ip/tcp/5001

# IPFS Gateway URL (for downloading pinned files)
R3MES_IPFS_GATEWAY_URL=https://ipfs.io/ipfs/

# ============================================================================
# Wallet Configuration
# ============================================================================
# Private key (hex format, REQUIRED for mining)
PRIVATE_KEY=your_private_key_hex_here

# Wallet address (derived from private key, optional if using PRIVATE_KEY)
WALLET_ADDRESS=remes1xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================================================
# Model Configuration
# ============================================================================
# Base model path
BASE_MODEL_PATH=models

# Model IPFS hash (if using IPFS model)
R3MES_MODEL_IPFS_HASH=QmYourModelHashHere

# Model name (if using HuggingFace)
R3MES_MODEL_NAME=meta-llama/Meta-Llama-3-8B

# GGUF model path (for llama-cpp-python)
R3MES_GGUF_MODEL_PATH=models/Meta-Llama-3-8B-Instruct.Q4_K_M.gguf

# ============================================================================
# Training Configuration
# ============================================================================
# Model parameters
MODEL_HIDDEN_SIZE=768
LORA_RANK=8
LEARNING_RATE=0.0001

# Training settings
DETERMINISTIC=true
GRADIENT_ACCUMULATION_STEPS=4
TOP_K_COMPRESSION=0.1
BATCH_SIZE=4

# Task pool configuration
R3MES_MAX_PREFETCH=5
R3MES_LOCAL_BATCH_SIZE=1
R3MES_TASK_POOL_CLAIM_LIMIT=1
R3MES_TASK_POOL_QUERY_LIMIT=1000

# Shard configuration
R3MES_TOTAL_SHARDS=100

# Model version
R3MES_MODEL_VERSION=v1.0.0

# Loss scaling for BitNet integer format
R3MES_LOSS_SCALE_FACTOR=1000

# PoRep chunk size
R3MES_POREP_CHUNK_SIZE=1024

# GGUF model context size
R3MES_GGUF_N_CTX=2048

# ============================================================================
# GPU Configuration
# ============================================================================
# Multi-GPU settings
USE_MULTI_GPU=false
MULTI_GPU_DEVICE_IDS=0,1
USE_DDP=false

# GPU memory limit (MB, optional)
GPU_MEMORY_LIMIT_MB=

# ============================================================================
# Network Configuration
# ============================================================================
# P2P port for miner communication
P2P_PORT=9090

# Arrow Flight port (for gradient verification)
R3MES_ARROW_FLIGHT_PORT=8815

# WebSocket port for miner logs (default: same as REST port)
R3MES_WS_PORT=

# WebSocket path for miner logs
R3MES_WS_PATH=/ws?topic=miner_logs

# Stats HTTP server port
R3MES_STATS_PORT=8080

# Stats HTTP server host
R3MES_STATS_HOST=localhost

# Verification service address
# REQUIRED in production - do NOT use localhost
R3MES_VERIFICATION_SERVICE_ADDR=verification.r3mes.network:8815

# ============================================================================
# TLS/SSL Configuration
# ============================================================================
# Enable TLS/mTLS (production should use true)
R3MES_TLS_ENABLED=false

# TLS certificate paths (if TLS enabled)
R3MES_TLS_CERT_PATH=
R3MES_TLS_KEY_PATH=
R3MES_TLS_CA_PATH=

# ============================================================================
# Backend API Configuration
# ============================================================================
# Backend API URL (for version check, time sync, faucet, etc.)
# REQUIRED in production - do NOT use localhost
R3MES_BACKEND_URL=https://api.r3mes.network

# Faucet configuration
R3MES_FAUCET_BASE_URL=https://api.r3mes.network
R3MES_FAUCET_ENDPOINT=/faucet/claim
R3MES_FAUCET_AMOUNT=1000000uremes
R3MES_FAUCET_TIMEOUT=30

# LoRA manager timeout
R3MES_LORA_FETCH_TIMEOUT=10

# ============================================================================
# Serving Node Configuration (Optional)
# ============================================================================
# Enable serving node mode to provide inference services
# When enabled, miner will:
# 1. Download and load LoRA adapters from IPFS
# 2. Register with backend as available for inference
# 3. Accept chat requests and perform inference
# 4. Stream responses back to backend
R3MES_ENABLE_SERVING_NODE=false

# Serving node endpoint configuration
# Host to bind inference server to (default: 0.0.0.0)
R3MES_SERVING_NODE_HOST=0.0.0.0

# Port for inference server (default: 8081)
R3MES_SERVING_NODE_PORT=8081

# Full serving node endpoint URL (optional, auto-detected if not set)
# Set this if your miner is behind NAT or you need a specific URL
# R3MES_SERVING_NODE_URL=http://your-public-ip:8081

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_LEVEL=INFO
USE_JSON_LOGS=false

# ============================================================================
# Debug Configuration (Optional)
# ============================================================================
R3MES_DEBUG_MODE=false
R3MES_DEBUG_LEVEL=INFO
R3MES_DEBUG_COMPONENTS=

